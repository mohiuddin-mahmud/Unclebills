@model PublicHomeTabModel
@using Nop.Core.Domain.Catalog
@using Nop.Web.Framework.Mvc.Routing
@{
    var categoryCount = 0;
    if (Model.HomeTabCategoryModel.Count() > 0)
    {
        <div class="product-grid hometab-container">
            <div class="title">
                @T("Bestsellers")
            </div>
            <div class="tab-container">
                @foreach (var category in Model.HomeTabCategoryModel)
                {
                    <div class="categoryTab @(categoryCount==0 ? "active" : "")">@category.Name</div>
                    categoryCount++;
                }
            </div>

            <div class="tab-product-container">
                @foreach (var category in Model.HomeTabCategoryModel)
                {
                    <div class="item-grid tab-product-slider">
                        @foreach (var item in category.ProductOverviewModel)
                        {
                            <div class="item-box">
                                @await Html.PartialAsync("_ProductBox", item)
                            </div>
                        }
                    </div>
                }
            </div>
        </div>

        <script asp-location="Footer">
            $(function () {

                $(".tab-container .categoryTab").click(function () {
                    $(".categoryTab").removeClass("active");
                    $(this).addClass("active");                 
                    var itemIndex = $(".tab-container .categoryTab").index(this);
                    $(".tab-product-container .tab-product-slider").hide();
                    $(".tab-product-container .tab-product-slider:eq(" + itemIndex + ")").show();
                    $('.tab-product-slider').slick('refresh');
                });

                $('.tab-product-slider').slick({
                    infinite: true,
                    slidesToShow: 4,
                    slidesToScroll: 1,
                    dots: false,
                    arrow: true,
                    responsive: [
                        {
                            breakpoint: 1024,
                            settings: {
                                slidesToShow: 4,
                                slidesToScroll: 1,
                                infinite: true,
                                dots: false
                            }
                        },
                        {
                            breakpoint: 768,
                            settings: {
                                slidesToShow: 3,
                                slidesToScroll: 1
                            }
                        },
                        {
                            breakpoint: 480,
                            settings: {
                                slidesToShow: 2,
                                slidesToScroll: 1
                            }
                        }
                        // You can unslick at a given breakpoint now by adding:
                        // settings: "unslick"
                        // instead of a settings object
                    ]
                });
            });
        </script>
    }

}

